{{#if this.statusMsg}}
  <div><strong>{{this.statusMsg}}</strong></div>
{{/if}}

<br>

{{!-- Left edge --}}
<div class="card-manipulator--left-edge">
  {{!-- Profile sidebar --}}
  <div class="card-manipulator--left-edge--profile">
    <div class="profile icon"></div>
    <div class="settings icon active"></div>
    <div class="search icon"></div>
  </div>
  {{!-- Catalog fields list --}}
  <div class="card-manipulator--left-edge--catalog">
    <div class="title">Card Catalog</div>

    {{#each this.componentTypes as |field index|}}
      <div
        class="card-manipulator--left-edge--catalog-field"
        role="button"
        draggable="true"
        onmousedown={{action this.beginDragging field}}
        data-test-card-add-field-draggable={{index}}
      >
        {{! template-lint-disable no-inline-styles}}
        <div class="field-icon" style={{css-url "background-image" field.icon}}></div>
        <div class="field-content">
          <div class="field-content--title">{{field.title}}</div>
          <div class="field-content--description">{{field.description}}</div>
          <div class="field-content--type">Type: <code>{{field.type}}</code></div>
          <div class="field-content--info-icon"></div>
        </div>
      </div>
    {{/each}}
  </div>
</div>
<div class="card-manipulator--main">
  {{!-- Card --}}
  <div class="card-manipulator--card">
    <div class="card-manipulator--card-header">
      <div class="title">Card Schema</div>
      <code class="id">{{@card.id}}</code>
      {{#unless this.cardstackSession.isAuthenticated}}
        (Must be logged in to save the card.)
      {{/unless}}
      <span data-test-card-schema-is-dirty={{this.isDirtyStr}}>
        {{#if this.card.isDirty}}(unsaved){{/if}}
      </span>
      {{! eslint is confused by on helper }}
      {{! template-lint-disable attribute-indentation}}
      <button
        {{on "click" this.save}}
        class="done-btn"
        data-test-card-schema-save-btn
        disabled={{not this.cardstackSession.isAuthenticated}}
      >
        Cancel
      </button>
      <button {{on "click" this.save}}
        data-test-card-schema-save-btn
        disabled={{not this.cardstackSession.isAuthenticated}}
      >
        Save Card
      </button>
    </div>
    <CardRenderer
      @card={{this.card}}
      @format="isolated"
      @mode="schema"
      @removeField={{action this.removeField}}
      @setFieldName={{action this.setFieldName}}
      @setNeededWhenEmbedded={{action this.setNeededWhenEmbedded}}
      @setPosition={{action this.setPosition}}
    >
      <div
        class="card-manipulator--card--field--drop-zone"
        role="button"
        ondrop={{action this.dropField}}
        ondragover={{action this.dragOver}}
        ondragenter={{action this.toggleOverDropZone true}}
        ondragleave={{action this.toggleOverDropZone false}}
        data-test-card-add-field-drop-zone
      >
        Drop fields here to edit/add
      </div>

      {{#if this.isEditingSchema}}
        <FieldCreator
          @numFields={{this.card.isolatedFields.length}}
          @fieldTypeMappings={{this.fieldTypeMappings}}
          @addField={{action this.addField}}
          @field={{this.isEditingSchema}}
        />
      {{/if}}
    </CardRenderer>
  </div>
</div>

<br>

<h3>Card Document:</h3>
<CodeBlock
  @code={{this.cardJson}}
  @language="javascript"
/>