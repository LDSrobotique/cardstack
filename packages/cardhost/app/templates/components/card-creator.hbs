<h2 data-test-card-creator>Add Card</h2>

{{#if this.statusMsg}}
  <div data-test-card-creator-msg><strong>{{this.statusMsg}}</strong></div>
{{/if}}

<fieldset class="card-creator--new-card">
  <legend>New Card</legend>
  <label for="card__id">Card ID:</label>
  <Input
    @id="card__id"
    @size="60"
    @placeholder="e.g. local-hub::article-card::millenial-puppies"
    @value={{this.cardId}}
    @key-up={{action this.updateCardId}}
  />
  <p>(Note that updating the card id will remove any fields that you have created. This is just a scaffolding limitation.)</p>
</fieldset>

<br>

{{#if this.card}}
  <CardRenderer
    @card={{this.card}}
    @format="isolated"
    @mode="schema"
    @removeField={{action this.removeField}}
    @setNeededWhenEmbedded={{action this.setNeededWhenEmbedded}}
    @setPosition={{action this.setPosition}}
  >
    <div class="card-creator--field-btn-wrapper">
      {{#unless this.cardstackSession.isAuthenticated}}
        (Must be logged in to save the card.)
      {{/unless}}
      <button {{on "click" this.save}}
        data-test-card-creator-save-btn
        disabled={{not this.cardstackSession.isAuthenticated}}
      >
        Save Card
      </button>
    </div>
    <br>

    <FieldCreator
      @numFields={{this.card.isolatedFields.length}}
      @fieldTypeMappings={{this.fieldTypeMappings}}
      @addField={{action this.addField}}
    />
  </CardRenderer>
{{/if}}

<br>

{{#if this.card}}
  <h3>Card Document:</h3>
  <CodeBlock
    @code={{this.cardJson}}
    @language="javascript"
  />
{{/if}}