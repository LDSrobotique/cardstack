<section class="card-renderer--container" data-test-card-view={{this.card.canonicalURL}}
  data-test-card-patched={{stringify this.patchCard.isIdle}}
  data-test-themer-loaded={{stringify this.isCardReady}}
>
  <div class="card-renderer--inner-container themer-container">
    <CardRenderer
      @card={{@card}}
      @format="isolated"
      @mode="view"
      @class="themer"
      @cardSelected={{false}}
      @suppressCss={{true}}
      @suppressHeader={{true}}
      @cardLoaded={{perform this.waitForCss}}
    />
  </div>
</section>

{{#if this.isCardReady}}
  <div data-test-editor-pane>
    <EditorPane data-test-dock-location={{this.cssModeToggle.dockLocation}}
      @css={{this.isolatedCss}}
      @card={{@card}}
      @updateCode={{this.updateCss}}
    />
  </div>
{{/if}}

<style data-test-view-css="themer">
  {{#if this.isolatedCss}}
    {{scope-css this.isolatedCss (concat (safe-css-string @card.canonicalURL) "--isolated")}}
  {{else}}
    {{scope-css this.loadingCss (concat (safe-css-string @card.canonicalURL) "--isolated")}}
  {{/if}}
</style>