<CardhostTopEdge @mode="schema">
  <div class="card-creator--top-edge">
    {{! eslint is confused by on helper }}
    {{! template-lint-disable attribute-indentation}}
    <button
      {{on "click" this.save}}
      class="ch-button primary"
      data-test-card-creator-save-btn
      disabled={{not this.cardstackSession.isAuthenticated}}
    >
      Save
    </button>

    {{#unless this.cardstackSession.isAuthenticated}}
      (Must be logged in to save the card.)
    {{/unless}}
  </div>
</CardhostTopEdge>

<CardhostLeftEdge>
  <section class="cardhost-left-edge--catalog">
    <h3 class="title">Card Catalog</h3>
    {{#each this.fieldComponents as |field|}}
      {{! eslint is confused by on helper }}
      {{! template-lint-disable attribute-indentation}}
      <section
        class="cardhost-left-edge--catalog-field"
        role="button"
        draggable="true"
        {{on "mousedown" (action this.beginDragging field)}}
        {{on "dragend" (action (mut this.isDragging) false)}}
        data-test-card-add-field-draggable={{field.type}}
      >
        {{! template-lint-disable no-inline-styles}}
        <div class="field-icon" style={{css-url "background-image" field.icon}}></div>
        <div class="field-content">
          <h4 class="field-content--title">{{field.title}}</h4>
          {{#if field.description}}
            <p class="field-content--description">{{field.description}}</p>
          {{/if}}
          <div class="field-content--type">Type: <code>{{field.type}}</code></div>
        </div>
      </section>
    {{/each}}
  </section>
</CardhostLeftEdge>

<div class="card-manipulator--right-edge" data-test-right-edge>
  {{#if this.selectedField}}
    <div class="card-manipulator--right-edge--pill-selector">
      <div class="card-manipulator--right-edge--pill-option selected">Properties</div>
      <div class="card-manipulator--right-edge--pill-option">Structure</div>
    </div>
    <div class="card-manipulator--right-edge--section">
      <div class="section-header">Text Field</div>
      <div class="card-manipulator--right-edge--attribute">
        <div class="attribute-title">Field Name</div>
        <Input
          data-test-field-name
          @id={{concat "card-manipulator--right-edge--field-name-" this.selectedField.nonce}}
          @value={{this.selectedFieldName}}
          @key-up={{action this.updateFieldName}}
        />
      </div>
      <div class="card-manipulator--right-edge--attribute">
        <div class="attribute-title">Display Label</div>
        <Input class="attribute-value" />
      </div>
      <div class="card-manipulator--right-edge--attribute">
        <label class="checkbox-container">
          Required
          <Input @type="checkbox" />
          <span class="checkmark"></span>
        </label>
      </div>
      <div class="card-manipulator--right-edge--attribute">
        <label class="checkbox-container">
          Available When Embedded
          <Input
            @checked={{this.selectedField.neededWhenEmbedded}}
            @type="checkbox"
            @click={{fn this.setNeededWhenEmbedded this.selectedField.name}}
            data-test-needed-when-embedded
            />
          <span class="checkmark"></span>
        </label>
      </div>
    </div>
  {{/if}}
</div>

<div class="card-manipulator--container card-creator">
  {{#if this.statusMsg}}
    <p data-test-card-creator-msg><strong>{{this.statusMsg}}</strong></p>
  {{/if}}

  <fieldset class="card-creator--new-card">
    <legend>New Card</legend>
    <label for="card__id">Card ID:</label>
    <Input
      @id="card__id"
      @size="60"
      @placeholder="e.g. millenial-puppies"
      @value={{this.cardId}}
      @key-up={{action this.updateCardId}}
    />
    <p>(Note that updating the card id will remove any fields that you have created. This is just a scaffolding limitation.)</p>
  </fieldset>

  {{#if this.card}}
    <section class="card-manipulator" data-test-card-creator>
      <header class="card-manipulator--header">
        <h2>New Card</h2>
        <code>{{@card.name}}</code>
      </header>
      <CardRenderer
        @card={{this.card}}
        @format="isolated"
        @mode="schema"
        @removeField={{action this.removeField}}
        @setPosition={{action this.setPosition}}
        @selectField={{action this.selectField}}
        @dropField={{action this.dropField}}
      />
    </section>
  {{/if}}

  {{#if this.card}}
    <section class="cardhost-card-document">
      <h3>Card Document</h3>
      <CodeBlock
        @code={{this.cardJson}}
        @language="javascript"
      />
    </section>
  {{/if}}
</div>
